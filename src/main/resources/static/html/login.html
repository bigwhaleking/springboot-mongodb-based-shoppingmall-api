<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>쇼핑몰 이름 정하기</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
</head>
<body>

<nav class="navbar navbar-expand-lg bg-body-tertiary">
    <div class="container-fluid">
        <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
            <div class="navbar-nav">
                <a class="nav-link active" aria-current="page" href="http://localhost:8080/">Home</a>
            </div>
        </div>
    </div>
</nav>

<div class="container mt-4">
    <form id="loginForm" method="POST">
        <fieldset>
            <legend>로그인</legend>
            <div class="mb-3">
                <label for="id" class="form-label">아이디</label>
                <input type="text" id="id" class="form-control" name="id">
            </div>
            <div class="mb-3">
                <label for="pw" class="form-label">비밀번호</label>
                <input type="password" id="pw" class="form-control" name="pw">
            </div>
            <button type="submit" class="btn btn-outline-dark">로그인</button>
            <a href="register" class="btn btn-outline-success">회원가입</a>
        </fieldset>
    </form>
</div>

<script>
document.getElementById("loginForm").addEventListener("submit", function(event) {
    event.preventDefault(); // 폼의 기본 동작인 페이지 새로고침을 막습니다.
    
    var id = document.getElementById("id").value;
    var pw = document.getElementById("pw").value;
    
    // AJAX 요청을 보냅니다.
    var xhr = new XMLHttpRequest();
    xhr.open("POST", "/login");
    xhr.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
    xhr.onreadystatechange = function() {
        if (xhr.readyState === XMLHttpRequest.DONE) {
            console.log("Response received:", xhr.status, xhr.responseText);
            if (xhr.status === 200) {
                alert("로그인 성공!");
                if(id == "admin")
                {
                	window.location.href = "adminpage";
                	}
                	else
                	{
                window.location.href = "usermain"; // 로그인 성공 시 이동할 페이지의 경로
                }
            } else {
                alert("로그인 실패...");
            }
        }
    };
    var formData = "id=" + encodeURIComponent(id) + "&pw=" + encodeURIComponent(pw);
    xhr.send(formData);
});
</script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js" integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQ+zqX6gSbd85u4mG4QzX+" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.min.js" integrity="sha384-BBtl+eGJRgqQAUMxJ7pMwbEyER4l1g+O15P+16Ep7Q9Q+zqX6gSbd85u4mG4QzX+" crossorigin="anonymous"></script>

</body>
</html>
